

/*  Copyright (c) 1993-1996 Algorithms Corporation  */
/*  All rights reserved.  */




/*  This file automatically generated by dpp - do not edit  */

#define	DPP_STRATEGY	1
#define	DPP_FASTWIDE	0



#line 18 "client.d"
#include "oleclnt2.h" 

#include <initguid.h> 

#include "../classid.h" 

#define	CLASS	TestClient_c
#define	ivType	TestClient_iv_t

#include "generics.h"

object	TestClient_c;



#line 29 "client.d"
cmeth objrtn TestClient_cm_gNew(object self)
{ 
	return gNewOLEClient(self, &CLSID_Server); 
} 

imeth objrtn TestClient_im_gSetValues(object self, char *str, int val)
{ 
	int i; 

	OLEHEADER(2); 


	SetString(1, str); 
	SetShort(2, val); 


	OLEINVOKE("gSetValues"); 


	i = GetShort(); 


	OLEEND; 

	return self; 
} 

imeth char * TestClient_im_gGetString(object self)
{ 
	static char buf[80]; 

	OLEHEADER(0); 


	OLEINVOKE("gGetString"); 


	strcpy(buf, GetString()); 


	OLEEND; 

	return buf; 
} 


#line 80 "client.c"

objrtn	TestClient_initialize(void)
{
	static  CRITICALSECTION  cs;
	static  int volatile once = 0;

	ENTERCRITICALSECTION(_CI_CS_);
	if (!once) {
		INITIALIZECRITICALSECTION(cs);
		once = 1;
	}
	LEAVECRITICALSECTION(_CI_CS_);

	ENTERCRITICALSECTION(cs);

	if (TestClient_c) {
		LEAVECRITICALSECTION(cs);
		return TestClient_c;
	}
	INHIBIT_THREADER;
	OLEClient_initialize();
	if (TestClient_c)  {
		ENABLE_THREADER;
		LEAVECRITICALSECTION(cs);
		return TestClient_c;
	}
	TestClient_c = gNewClass(Class, "TestClient", 0, 0, OLEClient, END);
	cMethodFor(TestClient, gNew, TestClient_cm_gNew);
	iMethodFor(TestClient, gSetValues, TestClient_im_gSetValues);
	iMethodFor(TestClient, gGetString, TestClient_im_gGetString);

	ENABLE_THREADER;

	LEAVECRITICALSECTION(cs);

	return TestClient_c;
}



